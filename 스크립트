using UnityEngine;

public class CarFollowWaypoints : MonoBehaviour
{
    public Transform[] waypoints;       // 웨이포인트 배열
    public float speed = 5f;            // 이동 속도
    public float turnSpeed = 5f;        // 회전 속도
    private int currentIndex = 0;       // 현재 목표 웨이포인트 인덱스

    void Update()
    {
        if (waypoints.Length == 0) return;

        Transform target = waypoints[currentIndex];

        // 이동 방향 계산
        Vector3 direction = (target.position - transform.position).normalized;

        // 이동
        transform.position += direction * speed * Time.deltaTime;

        // 회전
        Quaternion lookRotation = Quaternion.LookRotation(direction);
        transform.rotation = Quaternion.Slerp(transform.rotation, lookRotation, Time.deltaTime * turnSpeed);

        // 웨이포인트에 거의 도달하면 다음 웨이포인트로 이동
        if (Vector3.Distance(transform.position, target.position) < 1f)
        {
            currentIndex++;
            if (currentIndex >= waypoints.Length)
                currentIndex = 0; // 다시 처음부터 순환
        }
    }
}
